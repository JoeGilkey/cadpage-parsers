package net.anei.cadpage.parsers.VA;

import java.util.Properties;
import java.util.regex.Pattern;

import net.anei.cadpage.parsers.CodeSet;
import net.anei.cadpage.parsers.MsgInfo.Data;
import net.anei.cadpage.parsers.dispatch.DispatchDAPROParser;



public class VARockinghamCountyParser extends DispatchDAPROParser {

  public VARockinghamCountyParser() {
    this("ROCKINGHAM COUNTY", "VA");
  }
  protected VARockinghamCountyParser(String defCity, String defState) {
    super(CITY_CODES, defCity, defState);
    setupCallList(CALL_SET);
    setupMultiWordStreets(MWORD_STREET_LIST);
  }
  
  @Override
  public String getAliasCode() {
    return "VARockinghamCounty";
  }

  @Override
  public String getFilter() {
    return "messaging@iamresponding.com,mailbox@hrecc.org,MAILBOX@pagesheriff.COM,93001,5402446442";
  }

  private static final Pattern MASHED_SUBJECT_PTN = Pattern.compile("[A-Z]+\\d+ \\d\\d|.* CROSS");
  @Override
  public boolean parseMsg(String subject, String body, Data data) {
    
    body = body.replace("\n", "");
    if (MASHED_SUBJECT_PTN.matcher(subject).matches()) {
      boolean prefix = body.startsWith("MAILBOX:");
      if (prefix) body = body.substring(8);
      body = subject + ":" + body;
      if (prefix) body = "MAILBOX:" + body;
      subject = "";
    }
    return super.parseMsg(subject, body, data);
  }
  
  private static final String[] MWORD_STREET_LIST = new String[]{
    "AMERICAN LEGION",
    "ANDRICK MILL",
    "ANNIES RUN",
    "APPLE RIDGE",
    "APPLE VALLEY",
    "ASPEN HEIGHTS",
    "AUTUMN VIEW",
    "AYLOR GRUBBS",
    "BARK WAGON",
    "BATTLE BLUFF",
    "BEAR FOOT",
    "BEAR MOUNTAIN",
    "BEAVER CREEK",
    "BELLE BOYD",
    "BENNETT RUN",
    "BETHEL CHURCH",
    "BIG OAK",
    "BIRD SONG",
    "BLACK WALNUT",
    "BLOOMER SPRINGS",
    "BLUE BELL",
    "BLUE HERON",
    "BLUE MOUNTAIN",
    "BLUESTONE HILLS",
    "BOWMAN ORCHARD",
    "BRANCH POINT",
    "BRIDGEWATER COLLEGE",
    "BRIERY BRANCH",
    "BROCKS GAP",
    "BRYANT HOLLOW",
    "BULL RUN",
    "BYRD ORCHARD",
    "CABIN VIEW",
    "CAINEY HOLLOW",
    "CAMPUS VIEW",
    "CANNERY WOODS",
    "CANOE RIVER",
    "CAPT SHANDS",
    "CAPTAIN YANCEY",
    "CEDAR KNOB",
    "CEDAR SPRING",
    "CHERRY GROVE",
    "CHESTNUT RIDGE",
    "CINDER RUN",
    "CIRCLE R",
    "CLEM HOLLOW",
    "CLOVER HILL",
    "COAL RUN",
    "COLLEGE VIEW",
    "COMMUNITY CENTER",
    "CONVOCATION SERV",
    "COOK TOWN",
    "COOKS CREEK",
    "COOPERS MOUNTAIN",
    "COOPERS MTN",
    "COUNTRY CLUB",
    "CRAB RUN",
    "CROSS KEYS",
    "DANIEL CUPP",
    "DAVE BERRY",
    "DAVIS MILLS",
    "DEAN MOUNTAIN",
    "DEL WEBB",
    "DON LITTEN",
    "DOVE LANDING",
    "DRY HOLLOW",
    "DRY RIVER",
    "DRY RUN ACRES",
    "DRY RUN",
    "DUCK RUN",
    "DUTCH MILL",
    "EAGLE ROCK",
    "EAST POINT",
    "EAST SIDE",
    "ECHO MOUNTAIN",
    "EGYPT BEND",
    "ELLENS ROOST",
    "ELON RHODES",
    "EVELYN BYRD",
    "EVERGREEN VALLEY",
    "FOREST HILL",
    "FORT LYNNE",
    "FORT RUN",
    "FOUR WHEEL",
    "FOX FARM",
    "FOX MOUNTAIN",
    "FRANK LANE",
    "FRIDLEY'S GAP",
    "FRIEDENS CHURCH",
    "GARBERS CHURCH",
    "GARDEN GATE",
    "GEN JACKSON",
    "GIANTS GRAVE",
    "GLEN COVE",
    "GLEN HOLLOW",
    "GLEN LOCH",
    "GLEN SCHOOL",
    "GOLDEN CREEK",
    "GOODS MILL",
    "GRACE CHAPEL",
    "GRANNY SMITH",
    "GRATTAN PRICE",
    "GREEN VALLEY",
    "GUM TREE",
    "HANSE MOUNTAIN",
    "HARNESS SHOP",
    "HARPER VALLEY",
    "HEMLOCK COVE",
    "HENTON MILL",
    "HICKORY MOUNTAIN",
    "HIDDEN CREEK",
    "HIDDEN OAKS",
    "HIDDEN VALLEY",
    "HILL GAP",
    "HILL VIEW",
    "HOLLEN MILL",
    "HOLLY HILL",
    "HOME VIEW",
    "HONE QUARRY",
    "HONEY RUN",
    "HOPKINS GAP",
    "HOREB CHURCH",
    "HUNTINGTON SPRINGS",
    "IKENBERRY SERVICE",
    "INDIAN SPRING",
    "INDIAN TRAIL",
    "ISLAND FORD",
    "J ELLIS",
    "J J",
    "JAMES EVELYN",
    "JESS AREY",
    "JESSE BENNETT",
    "JOHN HANCOCK",
    "JOHN PAUL JONES",
    "JOHN WAYLAND",
    "JOSEPH FUNK",
    "JUDGE PAUL",
    "KATHERINE FURANCE",
    "KATIE GROVE",
    "KETTLE VIEW",
    "KOINER FORD",
    "LACEY SPRING",
    "LADY BUG",
    "LAKESIDE SERVICE",
    "LAM CONLEY",
    "LAMBERT TOWN",
    "LAMS HAVEN",
    "LAST LEFT",
    "LAYMAN HOLLOW",
    "LEISURE LIVING",
    "LEWIS BYRD",
    "LIGHTNING BUG",
    "LINVILLE EDOM",
    "LITTLE DRY RIVER",
    "LITTLE GAP",
    "LITTLE PASS",
    "LITTLE SPRING",
    "LONE OAK",
    "LONE PINE",
    "LONG MEADOW",
    "LONG RUN",
    "LONGS PUMP",
    "LUMBER MILL",
    "LURAY MOBILE HOMES",
    "MAJESTIC VIEW",
    "MALL RING",
    "MAPLE BROOK",
    "MARTIN MILLER",
    "MASSANETTA SPRINGS",
    "MAUZY ATHLONE",
    "MEADOWS NORTH",
    "MEMORIAL PARK",
    "MILKY WAY",
    "MILL CREEK CHURCH",
    "MILL CREEK",
    "MILL RUN",
    "MINNICK HOLLOW",
    "MODULAR HILL",
    "MONGER HILL",
    "MORGANS RUN",
    "MORNING DOVE",
    "MORRIS POTTERY",
    "MOSSY CREEK",
    "MOUNT HERMON",
    "MOUNTAIN FARM",
    "MOUNTAIN LAUREL",
    "MOUNTAIN RUN",
    "MOUNTAIN SPRING",
    "MOUNTAIN VALLEY",
    "MOUNTAIN VIEW",
    "MT CARMEL",
    "MT CLINTON",
    "MT CRAWFORD",
    "MT HERMON",
    "MT PARAN CHURCH",
    "MT PLEASANT",
    "MT SINAI",
    "MUDDY CREEK",
    "MYSTIC WOODS",
    "NAKED CREEK",
    "NAZARENE CHURCH",
    "NEWDALE SCHOOL",
    "NOBLE CENTER",
    "NORTH MOUNTAIN",
    "NORTH RIVER",
    "NOW LOOK",
    "OAK HILL",
    "OAK RIDGE",
    "OAK SHADE",
    "OAK VILLA",
    "OLIVIA DAWN",
    "OSCEOLA SPRINGS",
    "PAGE VALLEY",
    "PAYNE HOLLOW",
    "PEACH GROVE",
    "PEACH ORCHARD",
    "PEAKE MOUNTAIN",
    "PENN LAIRD",
    "PETER DRIVER",
    "PHEASANT RUN",
    "PIG FARMERS",
    "PIKE CHURCH",
    "PINE GROVE",
    "PINE HARBOR",
    "PINEY WOODS",
    "PLAINS MILL",
    "PLEASANT HILL",
    "PLEASANT VALLEY",
    "PLEASANT VIEW",
    "PORCH SWING",
    "PORT HILLS",
    "PORT REPUBLIC",
    "PROSPECT KNOLL",
    "PULSES HILL",
    "QUIET KNOLL",
    "RADERS CHURCH",
    "RAGGEDY ANN",
    "RED BARN",
    "RED BRUSH",
    "RED CHURCH",
    "RED HILL",
    "RED OAK",
    "RINACAS CORNER",
    "RIVER STONE",
    "RIVER VIEW",
    "ROBIN HILL",
    "ROCK CAVE",
    "ROCK PORT",
    "ROCKING PAGE",
    "ROCKY RUN",
    "ROLLING CREEK",
    "ROSE HILL",
    "ROUND HILL",
    "RUFFS RIDGE",
    "RUNKLES GAP",
    "SAND PIT",
    "SANDY BOTTOM",
    "SANDY HOOK",
    "SAPLING RIDGE",
    "SHADY OAK",
    "SHELL HOLLOW",
    "SHENANDOAH MOUNTAIN",
    "SHENANDOAH RIVER",
    "SHIFFLETT HILL",
    "SHORT RUN",
    "SILVER CREEK",
    "SILVER LAKE",
    "SIMMERS VALLEY",
    "SINGERS GLEN",
    "SKIDMORE FORK",
    "SLAB TOWN",
    "SMITH MOUNTAIN",
    "SNAPPS CREEK",
    "SOCCER FIELD SERVICE",
    "SOUTH BRANCH",
    "SOUTH CREEK",
    "SPADERS CHURCH",
    "SPAR MINE",
    "SPRING CREEK",
    "SPRING DALE",
    "ST STEPHENS",
    "STEAMBOAT HOLLOW",
    "STEPHEN CONRAD",
    "STONE HILL",
    "STONE SPRING",
    "STROLE FARM",
    "SUGAR MAPLE",
    "SUN VALLEY",
    "SUNNY SLOPE",
    "SWEET CORN",
    "SWEET MAGNOLIA",
    "SWITZER LAKE",
    "TALL CEDARS",
    "TANNERS RIDGE",
    "TANYARD BRIDGE",
    "TARA DAWN",
    "TAYLOR GROVE",
    "TAYLOR SPRING",
    "THIRTY THREE",
    "THOMAS SPRING",
    "THORNY BRANCH ROAD",
    "THREE LEAGUES",
    "THREE SPRINGS",
    "TIMBER RIDGE",
    "TOWN RESERVOIR",
    "TRAILING IVY",
    "TREE SIDE",
    "TRINITY CHURCH",
    "TRIPLE Z",
    "TURNER ASHBY",
    "UNION SPRINGS",
    "VALLEY OVERLOOK",
    "VALLEY VIEW",
    "VISTA GLEN",
    "WAGGYS CREEK",
    "WALKING HORSE",
    "WAR BRANCH",
    "WATER WHEEL",
    "WEEPING WILLOW",
    "WELL HOLLOW",
    "WEST PEAKE",
    "WEST VIEW",
    "WEST WIND",
    "WHISPERING WINDS",
    "WHITE PICKET",
    "WHITESEL CHURCH",
    "WHITMORE SHOP",
    "WILLIE B",
    "WILLOW HILL",
    "WILLOW ROSE",
    "WILLS CREEK",
    "WINDY COVE",
    "WINDY KNOLL",
    "WINE STORE",
    "WISE HOLLOW",
    "WOODED VIEW",
    "WYNDHAM WOODS",
    "ZION CHURCH",
    "ZIRKLE HEIGHTS"
  };

  private static final CodeSet CALL_SET = new CodeSet(
      "911 OPEN LINE",
      "ABDOMINAL PAIN",
      "ALARM SOUNDING",
      "ALCOHOL RELATED ILLNESS-LIFE T",
      "ALCOHOL RELATED ILLNESS-NON LI",
      "ALLERGIC REACTION",
      "ALLERGIC REACTION-LIFE THREATE",
      "ALLERGIC REACTION-NON LIFE THR",
      "ALS ASSIST",
      "ALTERED LOC",
      "ANIMAL BITE-MINOR INJURY",
      "ANIMAL BITE-SEVERE INJURY",
      "AUTOMATIC FIRE ALARM",
      "BACK PAIN",
      "BLEEDING CONTROLLED",
      "BLEEDING UNCONTROLLED",
      "BRUSH FIRE",
      "BRUSH FIRE THREATENING A STRUC",
      "BURNS-MINOR/NON LIFE THREAT",
      "BURNS-SEVER/LIFE THREATENING",
      "CARDIAC ARREST",
      "CARDIAC CALL",
      "CARDIAC CALL TANNERS RIDGE OVERLOOK SNP",
      "CARDIAC CONDITION",
      "CHEST PAIN",
      "CHEST PAINS",
      "CHOKING-FR",
      "CO EVENT W/O ILLNESS",
      "COMMERCIAL ALARM",
      "CONTROLLED BURN",
      "DIABETIC EMERGENCY",
      "DIABETIC EMERGENCY-LIFE THREAT",
      "DIABETIC EMERGENCY-NON LIFE TH",
      "DIFFICULTY BREATHING",
      "DIZZINESS",
      "DROWNING/NEAR DROWNING",
      "ELEVATOR ENTRAPMENT",
      "EMS-ABDOMINAL PAIN",
      "EMS-CARDIAC CONDITION",
      "EMS-CHEST PAIN",
      "EMS-DIFFICULTY BREATHING",
      "EMS-FALLS",
      "EMS-ILLNESS",
      "EMS-MENTAL PROBLEM",
      "EMS-STROKE",
      "EMS-TRAUMA INJURIES",
      "EXPLOSION",
      "EXPOSURE TO HEAT/COLD-MAJOR",
      "EXPOSURE TO HEAT/COLD-MINOR",
      "FALLS>PATIENT HEIGHT-MAJOR INJ",
      "FALLS<PATIENT HEIGHT-MINOR INJ",
      "FEVER-NON-LIFE THREATENING",
      "FILL QUARTERS",
      "FIRE ALARM",
      "FIRE REPORTED OUT ALMA RECYCLING CENTER",
      "FRACTURE CLOSED-MAJOR",
      "FRACTURE CLOSED-MINOR",
      "GENERAL ILLNESS",
      "GRASS FIRE",
      "GRASS FIRE CROSS",
      "GRASS FIRE THREATENING A STRUC",
      "GUNSHOT-MINOR",
      "HAZMAT INCIDENT",
      "HEADACHE",
      "HEMORRHAGING",
      "HYPER/HYPOTENSIVE EVENT-MAJOR",
      "HYPER/HYPOTENSIVE EVENT-MINOR",
      "ILLNESS",
      "ILLNESS-NON LIFE THREATENING",
      "INCIDENT STRUCTURE FIRE",
      "INDUSTRIAL ACCIDENT",
      "INJURIES FROM A FALL",
      "INJURIES FROM ASSAULT-MAJOR",
      "INJURIES FROM ASSAULT-MINOR",
      "INJURY - LEG, ARM, ETC.",
      "INJURY-MINOR",
      "LACERATION-MINOR",
      "LANDING ZONE",
      "LINES DOWN",
      "LOCK OUT SERVICE",
      "LZ SET-UP RILEYVILLE BAPTIST #31",
      "MANPOWER REQUESTED",
      "MEDICAL ALARM",
      "MENTAL HEALTH",
      "NON-RESPONSIVE PERSON",
      "NON-RESPONSIVE PERSON DARK HOLLOW FALLS SNP",
      "NOSEBLEED",
      "OB RELATED EVENT-MAJOR",
      "OB RELATED EVENT-MINOR",
      "ODOR INVESTIGATION",
      "ODOR INVESTIGATION IN STRUCTUR",
      "OVERDOSE",
      "OVERDOSE-LIFE THREATENING",
      "PAIN",
      "PERSON DOWN",
      "POSSIBLE STRUCTURE FIRE",
      "PSYCHIATRIC EMERGENCY",
      "PUBLIC SERVICE CALL",
      "PUBLIC SERVICE CALL NEW FAMILY DOLLAR",
      "REQUEST FOR ALS",
      "SEIZURE-ACTIVE",
      "SEIZURE-NOT ACTIVE OR MULTIPLE",
      "SEIZURES",
      "SIMPLE ASSAULT",
      "SIMPLE ASSAULT SOUTH END CONVENIENCE",
      "SMALL SPILL",
      "SMOKE IN THE AREA",
      "SMOKE INVESTIGATION",
      "SMOKE INVESTIGATION SANDY",
      "SPORTS INJURY-MINOR",
      "STAB WOUND (HEAD/CHEST/TORSO)",
      "STAND-BY",
      "STAND-BY BRIERY",
      "STAND-BY REDDISH",
      "STROKE/STROKE SYMPTOMS",
      "STRUCTURE FIRE",
      "SUICIDE ATTEMPT",
      "SUICIDE THREAT",
      "TRAFFIC CRASH",
      "TRAFFIC CRASH INVOLVING A BUS",
      "TRAFFIC CRASH INVOLVING A STRU",
      "TRAFFIC CRASH INVOLVING PEDEST",
      "TRAFFIC CRASH INVOLVING TRACTO",
      "TRAFFIC STOP",
      "TRANSFER QUARTERS",
      "TRANSFORMER/POLE FIRE",
      "TRANSFORMER/POLE FIRE 21063  BLUE AND",
      "TRAUMA INJURIES-MAJOR",
      "UNAUTHORIZED BURN",
      "UNCONSCIOUS PERSON",
      "UNKNOWN FIRE",
      "UNKNOWN MEDICAL",
      "UNKNOWN MEDICAL CONDITION",
      "UNKNOWN SITUATION",
      "UNRESPONSIVE PERSON",
      "UNRESPONSIVE PERSON 20593  BLUE AND",
      "VEHICLE FIRE",
      "VEHICLE FIRE INVOLVING TRACTOR",
      "VEHICLE FIRE THREATENING STRUC",
      "WATER EVENT",
      "WATER REMOVAL",
      "WELFARE CHECK",
      "WOMAN DOWN"

  );

  private static final Properties CITY_CODES = buildCodeTable(new String[]{
      "BER", "BERGTON",
      "BRO", "BROADWAY",
      "BRI", "BRIDGEWATER",
      "CLO", "CLOVER HILL",
      "DAY", "DAYTON",
      "ELK", "ELKTON",
      "FUL", "FULKS RUN",
      "GRO", "GROTTOES",
      "HAR", "HARRISONBURG",
      "HIN", "HINTON",
      "KEE", "KEEZLETOWN",
      "LIN", "LINVILLE",
      "LUR", "LURAY",
      "MCG", "MCGAHEYSVILLE",
      "MOU", "MOUNT CRAWFORD",
      "NEW", "NEW MARKET",
      "PEN", "PENN LAIRD",
      "POR", "PORT REPUBLIC",
      "SHE", "SHENANDOAH",
      "RIL", "RILEYVILLE",
      "ROC", "ROCKINGHAM COUNTY",
      "SIN", "SINGERS GLEN",
      "STA", "STANLEY",
      "TIM", "TIMBERVILLE",
      "WEY", "WEYERS CAVE"
  });
}