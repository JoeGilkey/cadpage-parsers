package net.anei.cadpage.parsers.VA;

import java.util.Properties;
import java.util.regex.Pattern;

import net.anei.cadpage.parsers.CodeSet;
import net.anei.cadpage.parsers.MsgInfo.Data;
import net.anei.cadpage.parsers.dispatch.DispatchDAPROParser;



public class VARockinghamCountyAParser extends DispatchDAPROParser {

  public VARockinghamCountyAParser() {
    this("ROCKINGHAM COUNTY", "VA");
  }
  protected VARockinghamCountyAParser(String defCity, String defState) {
    super(CITY_CODES, defCity, defState);
    setupCallList(CALL_SET);
    setupMultiWordStreets(MWORD_STREET_LIST);
  }
  
  @Override
  public String getAliasCode() {
    return "VARockinghamCounty";
  }

  @Override
  public String getFilter() {
    return "messaging@iamresponding.com,mailbox@hrecc.org,MAILBOX@pagesheriff.COM,93001,5402446442";
  }

  private static final Pattern MASHED_SUBJECT_PTN = Pattern.compile("[A-Z]+\\d+ \\d\\d|.* CROSS");
  @Override
  public boolean parseMsg(String subject, String body, Data data) {
    
    body = body.replace("\n", "");
    if (MASHED_SUBJECT_PTN.matcher(subject).matches()) {
      boolean prefix = body.startsWith("MAILBOX:");
      if (prefix) body = body.substring(8);
      body = subject + ":" + body;
      if (prefix) body = "MAILBOX:" + body;
      subject = "";
    }
    return super.parseMsg(subject, body, data);
  }
  
  private static final String[] MWORD_STREET_LIST = new String[]{
    "AMERICAN LEGION",
    "ANDRICK MILL",
    "ANNIES RUN",
    "APPLE RIDGE",
    "APPLE TREE",
    "APPLE VALLEY",
    "ASPEN HEIGHTS",
    "AUTUMN VIEW",
    "AYLOR GRUBBS",
    "BANK CHURCH",
    "BARK WAGON",
    "BATTLE BLUFF",
    "BEACON HILL",
    "BEAR FOOT",
    "BEAR MOUNTAIN",
    "BEAR RUN",
    "BEAR WALLOW",
    "BEAVER CREEK",
    "BELLE BOYD",
    "BENNETT RUN",
    "BETHEL CHURCH",
    "BIG BUCK",
    "BIG OAK",
    "BIG RUN",
    "BIRD SONG",
    "BLACK WALNUT",
    "BLAIR MEADOW",
    "BLOOMER SPRINGS",
    "BLUE BELL",
    "BLUE HERON",
    "BLUE MOUNTAIN",
    "BLUE RIDGE",
    "BLUE SPRUCE",
    "BLUESTONE HILLS",
    "BOWMAN ORCHARD",
    "BRANCH POINT",
    "BRIDGEWATER COLLEGE",
    "BRIERY BRANCH",
    "BROCKS GAP",
    "BROWN MOUNTAIN",
    "BROWNS GAP",
    "BRYANT HOLLOW",
    "BULL RUN",
    "BYRD ORCHARD",
    "CABIN VIEW",
    "CAINEY HOLLOW",
    "CAMPUS VIEW",
    "CANNERY WOODS",
    "CANOE RIVER",
    "CAPT SHANDS",
    "CAPTAIN YANCEY",
    "CC TURNER",
    "CECIL WAMPLER",
    "CEDAR KNOB",
    "CEDAR SPRING",
    "CHERRY GROVE",
    "CHERRY TREE",
    "CHESTNUT OAK",
    "CHESTNUT RIDGE",
    "CINDER RUN",
    "CIRCLE R",
    "CLEM HOLLOW",
    "CLOVER HILL",
    "COAKLEY TOWN",
    "COAL RUN",
    "COLD SPRING",
    "COLLEGE VIEW",
    "COMMUNITY CENTER",
    "CONVOCATION SERV",
    "COOK TOWN",
    "COOKS CREEK",
    "COOPERS MOUNTAIN",
    "COOPERS MTN",
    "COUNTRY CLUB",
    "CRAB RUN",
    "CROSS KEYS",
    "CRYSTAL SPRING",
    "DALE ENTERPRISE",
    "DANIEL CUPP",
    "DAVE BERRY",
    "DAVIS MILLS",
    "DEACON HILL",
    "DEAN MOUNTAIN",
    "DEER RIDGE",
    "DEER RUN",
    "DEL WEBB",
    "DIXIE RIDGE RUN",
    "DON LITTEN",
    "DOVE LANDING",
    "DRY HOLLOW",
    "DRY MEADOW",
    "DRY RIVER",
    "DRY RUN ACRES",
    "DRY RUN",
    "DUCK RUN",
    "DUTCH MILL",
    "EAGLE ROCK",
    "EAST POINT",
    "EAST SIDE",
    "ECHO HILLS",
    "ECHO MOUNTAIN",
    "EGYPT BEND",
    "ELLENS ROOST",
    "ELON RHODES",
    "ENDLESS CAVERNS",
    "EVELYN BYRD",
    "EVERGREEN VALLEY",
    "FAMILY TREE",
    "FLOWING SPRING",
    "FOREST HILL",
    "FOREST HOMES",
    "FOREST OAKS",
    "FORT LYNNE",
    "FORT RUN",
    "FOUR LEAF",
    "FOUR WHEEL",
    "FOX FARM",
    "FOX MOUNTAIN",
    "FRANK LANE",
    "FRIDLEY'S GAP",
    "FRIEDENS CHURCH",
    "FRUIT FARM",
    "GARBERS CHURCH",
    "GARDEN GATE",
    "GEN JACKSON",
    "GEORGE WINE",
    "GIANTS GRAVE",
    "GLEN COVE",
    "GLEN HOLLOW",
    "GLEN LOCH",
    "GLEN SCHOOL",
    "GOLDEN CREEK",
    "GOODS MILL",
    "GRACE CHAPEL",
    "GRANNY SMITH",
    "GRATTAN PRICE",
    "GREEN VALLEY",
    "GUM TREE",
    "HANSE MOUNTAIN",
    "HAPPY VALLEY",
    "HARNESS SHOP",
    "HARPER VALLEY",
    "HEALTH CAMPUS",
    "HEALTH CENTER",
    "HEMLOCK COVE",
    "HENTON MILL",
    "HICKORY MOUNTAIN",
    "HIDDEN BROOK",
    "HIDDEN CREEK",
    "HIDDEN HOLLOW",
    "HIDDEN OAKS",
    "HIDDEN VALLEY",
    "HIGH MEADOW",
    "HILL GAP",
    "HILL VIEW",
    "HOLLEN MILL",
    "HOLLY HILL",
    "HOME VIEW",
    "HONE QUARRY",
    "HONEY RUN",
    "HOP HILL",
    "HOPKINS GAP",
    "HOREB CHURCH",
    "HUFFMAN SERVICE",
    "HUNTINGTON SPRINGS",
    "IKENBERRY SERVICE",
    "INDIAN SPRING",
    "INDIAN TRAIL",
    "INTERSTATE VIEW",
    "ISLAND FORD",
    "J ELLIS",
    "J J",
    "JACOB BURNER",
    "JAMES EVELYN",
    "JESS AREY",
    "JESSE BENNETT",
    "JIM BRITT",
    "JOHN HANCOCK",
    "JOHN PAUL JONES",
    "JOHN WAYLAND",
    "JOSEPH FUNK",
    "JUDGE PAUL",
    "KATHERINE FURANCE",
    "KATIE GROVE",
    "KETTLE VIEW",
    "KING RUSSELL",
    "KOINER FORD",
    "LACEY SPRING",
    "LADY BUG",
    "LAKE TERRACE",
    "LAKESIDE SERVICE",
    "LAM CONLEY",
    "LAMBERT TOWN",
    "LAMS HAVEN",
    "LAST LEFT",
    "LAUREL BRIGADE",
    "LAUREL KNOLL",
    "LAUREL OAK",
    "LAYMAN HOLLOW",
    "LAYMAN TRESTLE",
    "LEISURE LIVING",
    "LEWIS BYRD",
    "LIGHTNING BUG",
    "LINVILLE EDOM",
    "LITTLE DRY RIVER",
    "LITTLE GAP",
    "LITTLE PASS",
    "LITTLE SPRING",
    "LIZARD HILL",
    "LONE OAK",
    "LONE PINE",
    "LONG MEADOW",
    "LONG RUN",
    "LONGS PUMP",
    "LOVERS LEAP",
    "LUCY LONG",
    "LUMBER MILL",
    "LURAY MOBILE HOMES",
    "MAJESTIC VIEW",
    "MALL RING",
    "MAPLE BROOK",
    "MARIA SON TAR",
    "MARTIN LUTHER KING JR",
    "MARTIN LUTHER KING",
    "MARTIN MILLER",
    "MASSANETTA SPRING",
    "MASSANETTA SPRINGS",
    "MAUZY ATHLONE",
    "MCDORMAN HILL",
    "MEADOWS NORTH",
    "MEMORIAL PARK",
    "MESINETTO CREEK",
    "MIDDLE RIDGE",
    "MILKY WAY",
    "MILL CREEK CHURCH",
    "MILL CREEK",
    "MILL RUN",
    "MINNICK HOLLOW",
    "MODULAR HILL",
    "MONGER HILL",
    "MOORES MILL",
    "MORGANS RUN",
    "MORNING DOVE",
    "MORRIS POTTERY",
    "MOSSY CREEK",
    "MOUNT HERMON",
    "MOUNTAIN FARM",
    "MOUNTAIN GROVE",
    "MOUNTAIN LAUREL",
    "MOUNTAIN RUN",
    "MOUNTAIN SPRING",
    "MOUNTAIN VALLEY",
    "MOUNTAIN VIEW",
    "MT CARMEL",
    "MT CLINTON",
    "MT CRAWFORD",
    "MT HERMON",
    "MT PARAN CHURCH",
    "MT PLEASANT",
    "MT SINAI",
    "MUDDY CREEK",
    "MYSTIC WOODS",
    "NAKED CREEK",
    "NATURE TRAIL",
    "NAZARENE CHURCH",
    "NEWDALE SCHOOL",
    "NOBLE CENTER",
    "NORTH MOUNTAIN",
    "NORTH RIVER",
    "NOW LOOK",
    "OAK HILL",
    "OAK RIDGE",
    "OAK SHADE",
    "OAK VILLA",
    "OLIVIA DAWN",
    "OSCEOLA SPRINGS",
    "PAGE VALLEY",
    "PARK LAWN",
    "PAYNE HOLLOW",
    "PEACH GROVE",
    "PEACH ORCHARD",
    "PEAKE MOUNTAIN",
    "PEAKS VIEW",
    "PEARL LAKE",
    "PENN LAIRD",
    "PETER DRIVER",
    "PETERFISH GAP",
    "PHEASANT RUN",
    "PHILLIPS STORE",
    "PIG FARMERS",
    "PIKE CHURCH",
    "PINE GROVE",
    "PINE HARBOR",
    "PINEY WOODS",
    "PLAINS MILL",
    "PLEASANT HILL",
    "PLEASANT RUN",
    "PLEASANT VALLEY",
    "PLEASANT VIEW",
    "POND SIDE",
    "PORCH SWING",
    "PORT HILLS",
    "PORT REPUBLIC",
    "POWELLS GAP",
    "POWER DAM",
    "PROSPECT KNOLL",
    "PULSES HILL",
    "QUAIL RUN",
    "QUIET ACRES",
    "QUIET KNOLL",
    "RADERS CHURCH",
    "RAGGEDY ANN",
    "RED BARN",
    "RED BRUSH",
    "RED CHURCH",
    "RED HILL",
    "RED OAK",
    "RINACAS CORNER",
    "RIVER STONE",
    "RIVER VIEW",
    "ROBIN HILL",
    "ROCK CAVE",
    "ROCK CREEK",
    "ROCK PORT",
    "ROCK SPRING",
    "ROCKING PAGE",
    "ROCKINGHAM PARK",
    "ROCKY BAR",
    "ROCKY RUN",
    "ROLLING CREEK",
    "ROSE HILL",
    "ROUND HILL",
    "RUFFS RIDGE",
    "RUNKLES GAP",
    "SAND PIT",
    "SANDY BOTTOM",
    "SANDY HOOK",
    "SAPLING RIDGE",
    "SCOTTS FORD",
    "SHADY OAK",
    "SHAVER MILL",
    "SHELL HOLLOW",
    "SHEN LAKE",
    "SHENANDOAH MOUNTAIN",
    "SHENANDOAH RIVER",
    "SHIFFLETT HILL",
    "SHORT RUN",
    "SILVER CREEK",
    "SILVER LAKE",
    "SIMMERS VALLEY",
    "SINGERS GLEN",
    "SKIDMORE FORK",
    "SLAB TOWN",
    "SMITH MOUNTAIN",
    "SNAPPS CREEK",
    "SOCCER FIELD SERVICE",
    "SOUTH BRANCH",
    "SOUTH CREEK",
    "SOUTH MOUNTAIN",
    "SOUTHERN BREEZE",
    "SPADERS CHURCH",
    "SPAR MINE",
    "SPARKLING SPRINGS",
    "SPLIT RAIL",
    "SPRING CREEK",
    "SPRING DALE",
    "SPRING MEADOW",
    "SPRING OAKS",
    "SPRING PORT",
    "ST MICHAELS",
    "ST STEPHENS",
    "STEAM ENGINE",
    "STEAMBOAT HOLLOW",
    "STEPHEN CONRAD",
    "STONE HILL",
    "STONE PORT",
    "STONE SPRING",
    "STROLE FARM",
    "SUGAR MAPLE",
    "SUN VALLEY",
    "SUNDANCE FOREST",
    "SUNNY SLOPE",
    "SWEET CORN",
    "SWEET MAGNOLIA",
    "SWITZER LAKE",
    "TALL CEDARS",
    "TALL OAKS",
    "TANNERS RIDGE",
    "TANYARD BRIDGE",
    "TARA DAWN",
    "TAYLOR GROVE",
    "TAYLOR SPRING",
    "THIRD HILL",
    "THIRTY THREE",
    "THOMAS SPRING",
    "THORNY BRANCH ROAD",
    "THORNY BRANCH",
    "THORNY HOLLOW",
    "THREE LEAGUES",
    "THREE SPRINGS",
    "TIMBER RIDGE",
    "TOWN HALL",
    "TOWN RESERVOIR",
    "TRAILING IVY",
    "TRAILS END",
    "TRAVEL MATES",
    "TREASURE HILL",
    "TREE SIDE",
    "TRINITY CHURCH",
    "TRIPLE Z",
    "TURNER ASHBY",
    "TWIN ACRES",
    "TWO MILE RUN",
    "UNION SPRINGS",
    "VALLEY OVERLOOK",
    "VALLEY VIEW",
    "VIEW MOUNTAIN",
    "VISTA GLEN",
    "WAGGYS CREEK",
    "WAGON WHEEL",
    "WALKING HORSE",
    "WALNUT BOTTOM",
    "WALNUT HILL",
    "WAR BRANCH",
    "WARM SPRINGS",
    "WATER WHEEL",
    "WEEPING WILLOW",
    "WELL HOLLOW",
    "WEST DRY RIVER",
    "WEST PEAKE",
    "WEST VIEW",
    "WEST WIND",
    "WHIPPOORWILL HOLLOW",
    "WHISPERING PINE",
    "WHISPERING WINDS",
    "WHITE PICKET",
    "WHITE PINE",
    "WHITE ROSE",
    "WHITESEL CHURCH",
    "WHITMORE SHOP",
    "WILD ROSE",
    "WILLIAMS RUN",
    "WILLIE B",
    "WILLOW HILL",
    "WILLOW ROSE",
    "WILLS CREEK",
    "WINDY COVE",
    "WINDY KNOLL",
    "WINE STORE",
    "WINTER PARK",
    "WISE HOLLOW",
    "WOOD HAVEN",
    "WOODED VIEW",
    "WOODLAND HILLS",
    "WYNDHAM WOODS",
    "ZION CHURCH",
    "ZIRKLE HEIGHTS"
  };

  private static final CodeSet CALL_SET = new CodeSet(
      "911 OPEN LINE",
      "ABDOMINAL PAIN",
      "ALARM SOUNDING",
      "ALCOHOL RELATED ILLNESS-LIFE T",
      "ALCOHOL RELATED ILLNESS-NON LI",
      "ALLERGIC REACTION",
      "ALLERGIC REACTION-LIFE THREATE",
      "ALLERGIC REACTION-NON LIFE THR",
      "ALS ASSIST",
      "ALTERED LOC",
      "AMPUTATION",
      "ANIMAL BITE-MINOR INJURY",
      "ANIMAL BITE-SEVERE INJURY",
      "AUTOMATIC FIRE ALARM",
      "BACK PAIN",
      "BLEEDING CONTROLLED",
      "BLEEDING UNCONTROLLED",
      "BRUSH FIRE",
      "BRUSH FIRE THREATENING A STRUC",
      "BURNS-MINOR/NON LIFE THREAT",
      "BURNS-SEVER/LIFE THREATENING",
      "CARDIAC ARREST",
      "CARDIAC CALL",
      "CARDIAC CONDITION",
      "CHEST PAIN",
      "CHEST PAINS",
      "CHOKING-FR",
      "CO EVENT W/O ILLNESS",
      "COMMERCIAL ALARM",
      "CONTROLLED BURN",
      "DIABETIC EMERGENCY",
      "DIABETIC EMERGENCY-LIFE THREAT",
      "DIABETIC EMERGENCY-NON LIFE TH",
      "DIFFICULTY BREATHING",
      "DIZZINESS",
      "DROWNING/NEAR DROWNING",
      "ELEVATOR ENTRAPMENT",
      "EMS-ABDOMINAL PAIN",
      "EMS-CARDIAC CONDITION",
      "EMS-CHEST PAIN",
      "EMS-DIFFICULTY BREATHING",
      "EMS-FALLS",
      "EMS-ILLNESS",
      "EMS-MENTAL PROBLEM",
      "EMS-STROKE",
      "EMS-TRAUMA INJURIES",
      "EXPLOSION",
      "EXPOSURE TO HEAT/COLD-MAJOR",
      "EXPOSURE TO HEAT/COLD-MINOR",
      "FEVER-LIFE THREATENING",
      "FALLS>PATIENT HEIGHT-MAJOR INJ",
      "FALLS<PATIENT HEIGHT-MINOR INJ",
      "FEVER-NON-LIFE THREATENING",
      "FILL QUARTERS",
      "FIRE ALARM",
      "FIRE REPORTED OUT",
      "FRACTURE CLOSED-MAJOR",
      "FRACTURE CLOSED-MINOR",
      "FRACTURE OPEN",
      "GENERAL ILLNESS",
      "GRASS FIRE",
      "GRASS FIRE CROSS",
      "GRASS FIRE THREATENING A STRUC",
      "GUNSHOT-MAJOR-AUTO LAUNCH",
      "GUNSHOT-MINOR",
      "HAZMAT INCIDENT",
      "HEAD INJURY-MAJOR/LIFE THREATE",
      "HEAD INJURY-MINOR",
      "HEADACHE",
      "HEMORRHAGING",
      "HYPER/HYPOTENSIVE EVENT-MAJOR",
      "HYPER/HYPOTENSIVE EVENT-MINOR",
      "ILLNESS",
      "ILLNESS-NON LIFE THREATENING",
      "INCIDENT STRUCTURE FIRE",
      "INDUSTRIAL ACCIDENT",
      "INJURIES FROM A FALL",
      "INJURIES FROM ASSAULT-MAJOR",
      "INJURIES FROM ASSAULT-MINOR",
      "INJURY - LEG, ARM, ETC.",
      "INJURY-MINOR",
      "LACERATION-MINOR",
      "LANDING ZONE",
      "LINES DOWN",
      "LOCK OUT SERVICE",
      "LZ SET-UP",
      "MANPOWER REQUESTED",
      "MEDICAL ALARM",
      "MENTAL HEALTH",
      "MULCH FIRE",
      "MULCH FIRE THREATENING A STRUC",
      "NON-RESPONSIVE PERSON",
      "NOSEBLEED",
      "OB RELATED EVENT-MAJOR",
      "OB RELATED EVENT-MINOR",
      "ODOR INVESTIGATION",
      "ODOR INVESTIGATION IN STRUCTUR",
      "OVERDOSE",
      "OVERDOSE-LIFE THREATENING",
      "PAIN",
      "PERSON DOWN",
      "POISONING-MINOR",
      "POSSIBLE STRUCTURE FIRE",
      "PSYCHIATRIC EMERGENCY",
      "PUBLIC SERVICE CALL",
      "REQUEST FOR ALS",
      "SEIZURE-ACTIVE",
      "SEIZURE-NOT ACTIVE OR MULTIPLE",
      "SEIZURE-MULTIPLE",
      "SEIZURES",
      "SIMPLE ASSAULT",
      "SMALL SPILL",
      "SMOKE IN THE AREA",
      "SMOKE INVESTIGATION",
      "SPORTS INJURY-MINOR",
      "STAB WOUND (HEAD/CHEST/TORSO)",
      "STAND-BY",
      "STROKE/STROKE SYMPTOMS",
      "STRUCTURE COLLAPSE",
      "STRUCTURE FIRE",
      "SUICIDE ATTEMPT",
      "SUICIDE THREAT",
      "TRAFFIC CRASH",
      "TRAFFIC CRASH INVOLVING A BUS",
      "TRAFFIC CRASH INVOLVING A STRU",
      "TRAFFIC CRASH INVOLVING PEDEST",
      "TRAFFIC CRASH INVOLVING TRACTO",
      "TRAFFIC STOP",
      "TRANSFER QUARTERS",
      "TRANSFORMER/POLE FIRE",
      "TRAUMA INJURIES-MAJOR",
      "TREE FIRE",
      "UNAUTHORIZED BURN",
      "UNCONSCIOUS PERSON",
      "UNKNOWN FIRE",
      "UNKNOWN MEDICAL",
      "UNKNOWN MEDICAL CONDITION",
      "UNKNOWN SITUATION",
      "UNRESPONSIVE PERSON",
      "VEHICLE FIRE",
      "VEHICLE FIRE INVOLVING TRACTOR",
      "VEHICLE FIRE THREATENING STRUC",
      "WATER EVENT",
      "WATER REMOVAL",
      "WELFARE CHECK",
      "WOMAN DOWN"

  );

  private static final Properties CITY_CODES = buildCodeTable(new String[]{
      "BER", "BERGTON",
      "BRO", "BROADWAY",
      "BRI", "BRIDGEWATER",
      "CLO", "CLOVER HILL",
      "DAY", "DAYTON",
      "ELK", "ELKTON",
      "FUL", "FULKS RUN",
      "GRO", "GROTTOES",
      "HAR", "HARRISONBURG",
      "HIN", "HINTON",
      "KEE", "KEEZLETOWN",
      "LIN", "LINVILLE",
      "LUR", "LURAY",
      "MCG", "MCGAHEYSVILLE",
      "MOU", "MOUNT CRAWFORD",
      "NEW", "NEW MARKET",
      "PEN", "PENN LAIRD",
      "POR", "PORT REPUBLIC",
      "SHE", "SHENANDOAH",
      "RIL", "RILEYVILLE",
      "ROC", "ROCKINGHAM COUNTY",
      "SIN", "SINGERS GLEN",
      "STA", "STANLEY",
      "TIM", "TIMBERVILLE",
      "WEY", "WEYERS CAVE"
  });
}